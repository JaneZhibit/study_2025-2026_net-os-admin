
---
# Preamble

## Author
author:
  name: Жибицкая Евгения Дмитриевна
  degrees: DSc
  orcid: 0000-0002-0877-7063
  email: 1132236130@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №16
subtitle: Базовая защита от атак типа «brute force»
license: CC BY
## Generic options
lang: ru-RU
crossref:
  lof-title: Список иллюстраций
  lot-title: Список таблиц
  lol-title: Листинги
## Formats
format:
### Pdf output format
  beamer:
    toc: true
    colorlinks: false
    toc-depth: 2
    slide_level: 2
    aspectratio: 169
    section-titles: true
    theme: metropolis
    themeoptions: progressbar=frametitle,sectionpage=progressbar,numbering=fraction
#### Language
    babel-lang: russian
    babel-otherlangs: english
### Html output
  revealjs:
    transition: slide
    margin: 0.2
    smaller: false
    output-ext: html
    theme: beige
    logo: _resources/image/logo_rudn.png
---

# Цель

## Цель работы

- Получить навыки работы с программным средством Fail2ban
- Обеспечить базовую защиту от атак типа «brute force»
- Настроить мониторинг и блокировку подозрительной активности

# Теоретические сведения

## О Fail2ban

- Программное средство защиты от несанкционированного доступа
- Отслеживает сетевую активность через сканирование лог-файлов
- Блокирует IP-адреса при выявлении подозрительной активности
- Работает через изменение правил межсетевого экрана

## Ключевые настройки

- `ignoreip` - IP-адреса для игнорирования
- `bantime` - время блокировки в секундах
- `findtime` - интервал отслеживания активности  
- `maxretry` - количество попыток до блокировки

# Ход работы

## Установка Fail2ban
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Переходим в режим суперпользователя и устанавливаем fail2ban
:::
::: {.column width="50%"}

![Установка fail2ban](image/1.jpg)

:::
::::::::::::::

## Мониторинг логов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Просмотр журнала fail2ban](image/2.jpg)
:::
::: {.column width="50%"}

Запускаем просмотр журнала событий fail2ban в реальном времени

:::
::::::::::::::

## Настройка защиты SSH
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Создаем файл конфигурации и настраиваем защиту SSH-сервера
:::
::: {.column width="50%"}

![Настройка защиты SSH](image/3.jpg)

:::
::::::::::::::

## Запуск службы
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Перезапуск fail2ban](image/4.jpg)
:::
::: {.column width="50%"}

Перезапускаем fail2ban и проверяем журнал событий

:::
::::::::::::::

## Защита HTTP-серверов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Включаем защиту для различных модулей Apache
:::
::: {.column width="50%"}

![Настройка защиты HTTP](image/5.jpg)

:::
::::::::::::::

## Мониторинг после настройки HTTP
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Журнал после настройки HTTP](image/6.jpg)
:::
::: {.column width="50%"}

Проверяем работу службы после настройки HTTP-защиты

:::
::::::::::::::

## Защита почтовых серверов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Настраиваем защиту для Postfix и Dovecot
:::
::: {.column width="50%"}

![Настройка защиты почты](image/7.jpg)

:::
::::::::::::::

## Финальная проверка логов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Журнал после настройки почты](image/8.jpg)
:::
::: {.column width="50%"}

Убеждаемся в корректной работе всех служб

:::
::::::::::::::

# Проверка работы

## Статус служб
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Проверяем общий статус fail2ban и статус защиты SSH
:::
::: {.column width="50%"}

![Статус fail2ban и SSH](image/9.jpg)

:::
::::::::::::::

## Настройка параметров
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Настройка maxretry](image/10.jpg)
:::
::: {.column width="50%"}



Устанавливаем максимальное количество ошибок для SSH равное 2

:::
::::::::::::::

## Тестирование блокировки
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

С клиента пытаемся подключиться с неправильным паролем
:::
::: {.column width="50%"}

![Неудачная попытка входа](image/11.jpg)

:::
::::::::::::::

## Проверка блокировки
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Блокировка IP-адреса](image/12.jpg)
:::
::: {.column width="50%"}

Убеждаемся, что IP-адрес клиента был заблокирован

:::
::::::::::::::

## Разблокировка IP
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Разблокируем IP-адрес и проверяем статус
:::
::: {.column width="50%"}

![Разблокировка IP-адреса](image/13.jpg)

:::
::::::::::::::

## Настройка исключений
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Настройка ignoreip](image/14.jpg)
:::
::: {.column width="50%"}

Добавляем IP-адрес клиента в список исключений

:::
::::::::::::::

## Применение изменений
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Перезапускаем службу и проверяем работу исключений
:::
::: {.column width="50%"}

![Перезапуск после ignoreip](image/15.jpg)

:::
::::::::::::::

## Финальная проверка
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Проверка ignoreip](image/16.jpg)
:::
::: {.column width="50%"}

Убеждаемся, что IP из ignoreip не блокируется

:::
::::::::::::::

# Автоматизация

## Подготовка конфигурации
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Создаем каталоги и копируем конфигурационные файлы
:::
::: {.column width="50%"}

![Копирование конфигурации](image/17.jpg)

:::
::::::::::::::

## Создание скрипта
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Создание скрипта protect.sh](image/18.jpg)
:::
::: {.column width="50%"}

Создаем исполняемый файл для автоматизации установки

:::
::::::::::::::

## Наполнение скрипта
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Прописываем скрипт автоматической установки и настройки
:::
::: {.column width="50%"}

![Содержимое скрипта protect.sh](image/19.jpg)

:::
::::::::::::::

## Интеграция с Vagrant
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Конфигурация Vagrantfile](image/20.jpg)
:::
::: {.column width="50%"}

Добавляем конфигурацию для автоматического выполнения скрипта

:::
::::::::::::::

# Выводы

## Итоги работы

- Успешно установлен и настроен Fail2ban
- Настроена защита SSH, HTTP и почтовых служб
- Проверена работа системы блокировки
- Реализована автоматизация процесса установки
- Получены практические навыки защиты от brute force атак

## Преимущества Fail2ban

- Простота настройки и использования
- Гибкая система правил и фильтров
- Эффективная защита от автоматических атак
- Интеграция с системными логами
- Возможность тонкой настройки под конкретные нужды
