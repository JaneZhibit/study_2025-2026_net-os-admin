---
# Preamble

## Author
author:
  name: Жибицкая Евгения Дмитриевна
  degrees: DSc
  orcid: 0000-0002-0877-7063
  email: 1132236130@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: Лабораторная работа №13
subtitle: Администрирование сетевых подсистем
license: CC BY
## Generic options
lang: ru-RU
crossref:
  lof-title: Список иллюстраций
  lot-title: Список таблиц
  lol-title: Листинги
## Formats
format:
### Pdf output format
  beamer:
    toc: true
    colorlinks: false
    toc-depth: 2
    slide_level: 2
    aspectratio: 169
    section-titles: true
    theme: metropolis
    themeoptions: progressbar=frametitle,sectionpage=progressbar,numbering=fraction
#### Language
    babel-lang: russian
    babel-otherlangs: english
### Html output
  revealjs:
    transition: slide
    margin: 0.2
    smaller: false
    output-ext: html
    theme: beige
    logo: _resources/image/logo_rudn.png
---

# Цель

## Цель работы

- Приобретение навыков настройки сервера NFS для удалённого доступа к ресурсам

# Настройка сервера NFS

## Установка и настройка
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Установка nfs-utils](image/1.jpg)
:::
::: {.column width="50%"}

На сервере установим необходимое программное обеспечение - пакеты nfs-utils.

:::
::::::::::::::

## Безопасность SELinux
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

В файле /etc/exports пропишем подключаемый через NFS общий каталог с доступом только на чтение.

![Файл /etc/exports](image/2.jpg)

:::
::: {.column width="50%"}
Создадим каталог, зададим контекст безопасности NFS, применим изменённую настройку SELinux к файловой системе

![Настройка SELinux](image/3.jpg)

:::
::::::::::::::

## Межсетевой экран 
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Настройка firewall](image/4.jpg)
:::
::: {.column width="50%"}

Запустим сервер и настроим межсетевой экран для работы.

:::
::::::::::::::


## Установка клиента
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

На клиенте установим необходимое для работы NFS программное обеспечение.

:::
::: {.column width="50%"}

![Установка на клиенте](image/5.jpg)

:::
::::::::::::::

## Проверка подключения
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Проверка экспорта](image/6.jpg)
:::
::: {.column width="50%"}

На клиенте попробуем посмотреть имеющиеся подмонтированные удалённые
ресурсы.
:::
::::::::::::::

## Проверка подключения
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Повторное подключение](image/7.jpg)
:::
::: {.column width="50%"}

Попробуем на сервере остановить сервис межсетевого экрана и
затем на клиенте вновь попробуем подключиться к удалённо смонтированному
ресурсу.
:::
::::::::::::::

## Сервер
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Задействованные при монтировании службы](image/8.jpg)
:::
::: {.column width="50%"}


![rpc-bind и mountd](image/9.jpg)
:::
::::::::::::::

## Клиент
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Проверка на клиенте](image/10.jpg)
:::
::: {.column width="50%"}

На клиенте проверим подключение удалённого ресурса
:::
::::::::::::::


## Монтирование ресурсов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

На клиенте создадим каталог, в который будет монтироваться удалённый ресурс, и подмонтируем дерево NFS, проверим что общий ресурс NFS подключён правильно

![Монтирование NFS](image/11.jpg)
:::
::: {.column width="50%"}

![Монтирование NFS](image/12.jpg)

:::
::::::::::::::

## Монтирование ресурсов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

На клиенте в конце файла /etc/fstab добавьте следующую запись 
server.edzhibitskaya.net:/srv/nfs /mnt/nfs nfs _netdev 0 0

:::
::: {.column width="50%"}

![/etc/fstab](image/13.jpg)

:::
::::::::::::::

## Монтирование ресурсов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Проверка статуса](image/14.jpg)
:::
::: {.column width="50%"}

Проверим наличие автоматического монтирования удалённых ресурсов при запуске операционной системы.

:::
::::::::::::::

# Подключение каталогов к дереву NFS

## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Каталог www](image/15.jpg)
:::
::: {.column width="50%"}

На сервере создадим общий каталог, в который затем будет подмонтирован каталог
с контентом веб-сервера, подмонтируем каталог web-сервера. Проверим что отображается в каталоге /srv/nfs на сервере и клиенте.
:::
::::::::::::::

## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

На сервере в файле /etc/exports добавим экспорт каталога веб-сервера с удалённого ресурса
:::
::: {.column width="50%"}
![/etc/exports](image/16.jpg)
:::
::::::::::::::

## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}
![Экспорт](image/17.jpg)
:::
::: {.column width="50%"}
Экспортируем все каталоги, упомянутые в файле и проверим на клиенте каталог /mnt/nfs
:::
::::::::::::::


## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![/etc/fstab](image/13.jpg)

:::
::: {.column width="50%"}

![Повторный экспорт. Каталог](image/19.jpg)

:::
::::::::::::::



# Подключение каталогов для работы пользователей


## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

На сервере под пользователем  в домашнем каталоге создаем каталог
common с полными правами доступа только для этого пользователя, а в нём файл.

:::
::: {.column width="50%"}

![Создание файла](image/20.jpg)

:::
::::::::::::::

## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Монтирование](image/21.jpg)

:::
::: {.column width="50%"}

На сервере создаем общий каталог для работы пользователя user по сети и подмонтируем каталог common пользователя  в NFS 

:::
::::::::::::::

## Подключение каталогов
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![/etc/exports](image/22.jpg)

:::
::: {.column width="50%"}


![/etc/fstab](image/23.jpg)

:::
::::::::::::::


## Каталоги. Доступ
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Экспорт](image/24.jpg)
:::
::: {.column width="50%"}

![Создание файла](image/25.jpg)
:::
::::::::::::::

## Каталоги. Доступ
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

На сервере посмотрим, появились ли изменения в каталоге пользователя.
:::
::: {.column width="50%"}

![Просмотр на сервере](image/26.jpg)
:::
::::::::::::::

# Внесение изменений

## Внесение изменений
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Каталоги. Создание файлов](image/27.jpg)
:::
::: {.column width="50%"}

![Скрипт сервера](image/28.jpg)
:::
::::::::::::::

## Внесение изменений
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

Написание скрипта для клиента.
:::
::: {.column width="50%"}

![Скрипт на клиенте](image/29.jpg)
:::
::::::::::::::

## Конфигурация Vagrant
:::::::::::::: {.columns align=center}
::: {.column width="50%"}

![Vagrantfile для сервера](image/30.jpg)

:::
::: {.column width="50%"}

![Vagrantfile для клиента](image/31.jpg)

:::
::::::::::::::

# Выводы

## Вывод

- В ходе работы были приобретены практические навыки по настройке сервера NFS для организации удаленного доступа к файловым ресурсам с соблюдением требований безопасности
