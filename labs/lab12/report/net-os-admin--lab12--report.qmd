---
# Preamble

## Author
author:
  name: Жибицкая Евгения Дмитриевна
  degrees: 
  orcid: 0000-0002-0877-7063
  email: 
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Лабораторная работа №12"
subtitle: "Дисциплина: Администрирование сетевых подсистем"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Продолжение работы с Rocky Linux, получение навыков по управлению системным временем и настройке синхронизации времени.


# Выполнение лабораторной работы

Запустим виртуальные машины сервер и клиент для работы. На сервере и клиенте посмотрим параметры настройки даты и времени,определим в какой временной зоне находятся сервер и клиент, поэкспериментируем с командой. Также посмотрим текущее системное и аппаратное время([рис. @fig-001], [рис. @fig-002] и [рис. @fig-003]).

![Просмотр времени на сервере](image/1.jpg){#fig-001 width=70%}

![Просмотр времени на клиенте](image/2.jpg){#fig-002 width=70%}

![Аппаратное время](image/3.jpg){#fig-003 width=70%}


Перейдем к настройке синхронизации времени.

Проверим, что уже установленно необходимое ПО([рис. @fig-004]) и проверим источники времени на машинах([рис. @fig-005]).


![Установка ПО](image/4.jpg){#fig-004 width=70%}

![Источники времени](image/5.jpg){#fig-005 width=70%}


На сервере откроем на редактирование файл /etc/chrony.conf и добавим строку([рис. @fig-006]), перезапустим службу, настроим межсетевой экран([рис. @fig-007])

![/etc/chrony.conf](image/6.jpg){#fig-006 width=70%}

![Перезапуск](image/7.jpg){#fig-007 width=70%}

На клиенте откроем файл /etc/chrony.conf и добавим строку, удалим все остальные строки с директивой server, перезапустим службу chronyd([рис. @fig-008] и [рис. @fig-009])

![/etc/chrony.conf](image/8.jpg){#fig-008 width=70%}

![Перезапуск](image/9.jpg){#fig-009 width=70%}


Проверим источники. Сервер теперь синхронизирован с внешними источниками времени, а клиент теперь использует сервер server.edzhibitskaya.net как основной источник([рис. @fig-010])

![/etc/chrony.conf](image/10.jpg){#fig-010 width=70%}

Остается внести изменения в настройки внутреннего окружения.

Перейдем в каталог для внесения изменений в настройки внутреннего окружения /vagrant/provision/server/, создадим в нём
каталог ntp, в который поместим в соответствующие подкаталоги конфигурационные файлы([рис. @fig-011])

![Каталоги на сервере](image/12.jpg){#fig-011 width=70%}

Создадим файл ntp.sh и добавим скрипт([рис. @fig-012])

![Исполняемый файл](image/11.jpg){#fig-012 width=70%}

Перейдем в каталог для внесения изменений в настройки внутреннего окружения на клиенте, проделаем аналогичные действия([рис. @fig-013])

![Каталоги на клиенте](image/14.jpg){#fig-013 width=70%}

Создадим файл ntp.sh и добавим скрипт([рис. @fig-014])

![Исполняемый файл](image/13.jpg){#fig-014 width=70%}

Внесем изменения в Vagranfile([рис. @fig-015] и [рис. @fig-016])

![Vagranfile](image/15.jpg){#fig-015 width=70%}

![Vagranfile](image/16.jpg){#fig-016 width=70%}


# Контрольные вопросы

1. Почему важна точная синхронизация времени для служб баз данных?

Для обеспечения согласованности транзакций, предотвращения конфликтов данных и корректной работы репликации.

2. Почему служба проверки подлинности Kerberos сильно зависит от правильной синхронизации времени?

Kerberos использует временные метки для предотвращения replay-атак. Расхождение времени более 5 минут приводит к отказам в аутентификации.

3. Какая служба используется по умолчанию для синхронизации времени на RHEL 7?

chronyd

4. Какова страта по умолчанию для локальных часов?

Stratum 3

5. Какой порт брандмауэра должен быть открыт, если вы настраиваете свой сервер как одноранговый узел NTP?

123/UDP
 
6. Какую строку вам нужно включить в конфигурационный файл chrony, если вы хотите быть сервером времени, даже если внешние серверы NTP недоступны?

local stratum 10

7. Какую страту имеет хост, если нет текущей синхронизации времени NTP?

Stratum 16

8. Какую команду вы бы использовали на сервере с chrony, чтобы узнать, с какими серверами он синхронизируется?

chronyc sources

9. Как вы можете получить подробную статистику текущих настроек времени для процесса chrony вашего сервера?

chronyc tracking


# Выводы

 
В ходе работы были получены навыки по управлению системным временем и настройке синхронизации времени.


# Список литературы{.unnumbered}

[ТУИС](https://esystem.rudn.ru/pluginfile.php/2854778/mod_resource/content/5/012-ntp.pdf)

::: {#refs}
:::
